<!DOCTYPE html>
<html>

<head>
  <title>RanTreker Admin - Race Details</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/racedetails.css">
  <script src="/js/racedetails.js" defer></script>
</head>

<body>

  <div class="sidebar">
    <div class="logo">
      <img src="/img/RanTreker Logo.png" alt="RANTREKER Logo">
    </div>
    <br><br>
    <div class="menu">
      <a th:href="@{/admin/members}" class="inactive">Members</a>
      <a th:href="@{/admin/races}" class="active">Races</a>
      <a th:href="@{/admin/addRace}" class="inactive">Add Race</a>
      <a th:href="@{/logout}" class="inactive">Logout</a>
    </div>
  </div>

  <div class="content">
    <div class="container">
      <h1>Participating Members</h1>

      <h2 th:text="${race.title}"></h2>
      <h2 th:text="${size} + ' Participants'">2 Participants</h2>

      <div th:if="${successMessage}" class="alert alert-success">
        <p th:text="${successMessage}"></p>
      </div>

      <table>
        <thead>
          <tr>
            <th>Position</th>
            <th>Name</th>
            <th>Distance</th>
            <th>Duration</th>
            <th>Speed</th>
            <th>Image</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="raceParticipant, stat : ${raceParticipants}">
            <td th:text="${stat.index + 1} + '.'"></td>
            <td th:text="${raceParticipant.name}"></td>
            <td th:text="${raceParticipant.distance} + ' km'"></td>
            <td><pre th:text="${raceParticipant.duration}"></pre></td>
            <td th:text="${raceParticipant.speed_km_min} + ' km/min'"></td>
            <td><img class="race-image" th:src="@{'/race_images/' + ${raceParticipant.image_location}}" alt=""></td>
            <td><a class="delete-link"
                th:onclick="confirmDelete([[${raceParticipant.race_id}]], [[${raceParticipant.user_id}]])">Remove
                Participant</a></td>
          </tr>
          <tr th:if="${raceParticipants.empty}">
            <td colspan="7" style="text-align: center;">No participants have registered for this race.</td>
          </tr>
        </tbody>
      </table>

      <div id="reasonModal">
        <div>
          <h3>Reason for Deletion</h3>
          <form id="deletionReasonForm">
            <input type="hidden" name="id" id="id" value="0">
            <input type="hidden" name="user_id" id="user_id" value="0">
            <textarea id="message" name="message" placeholder="Enter reason for deletion" required></textarea>
            <br><br>
            <button type="submit">Delete</button>
            <button type="button" onclick="closeModal()">Cancel</button>
          </form>
        </div>
      </div>

      <br>
      <button class="back-button" onclick="window.location.href='/admin/races'">Back</button>
    </div>
  </div>
</body>

</html>